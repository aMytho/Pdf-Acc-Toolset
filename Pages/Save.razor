@using Pdf_Acc_Toolset.Services;
@page "/save"
@inject IJSRuntime JSRuntime

<h2 text-4xl font-bold>Save and Export</h2>

<p>Its done!</p>

<button @onclick="SavePdf">Save the PDF</button>
<hr />
<button @onclick="DownloadBinary">Download binary file</button>
<hr />
<button @onclick="DownloadText">Download text file</button>

@code {
	public void SavePdf()
	{
		TaskManager.RunQueuedTasks();
		PdfManager.Save();
	}

	async Task DownloadBinary()
    {
        // Generate a file
        byte[] file = Enumerable.Range(0, 100).Select(value => (byte)value).ToArray();
        byte[] data = PdfManager.outFile.ToArray();

        // Send the data to JS to actually download the file
        await JSRuntime.InvokeVoidAsync("BlazorDownloadFile", "1abc.pdf", "application/octet-stream", data);
    }

    async Task DownloadText()
    {
        // Generate a text file
        byte[] file = System.Text.Encoding.UTF8.GetBytes("Hello world!");
        await JSRuntime.InvokeVoidAsync("BlazorDownloadFile", "file.txt", "text/plain", file);
    }
}

